
var japodeApp=angular.module("japodeApp",["angularMoment","ngSanitize","ngRoute","japodeOauth"]);japodeApp.config(function(b,a){b.when("/",{redirectTo:"/blog"}).when("/japode",{templateUrl:"http://"+jp_domain+"/template/welcome.html",controller:"WelcomeController"}).when("/intro",{templateUrl:"http://"+jp_domain+"/template/intro.html",controller:"AddOrderController"}).when("/blog",{templateUrl:"http://"+jp_domain+"/template/blog.html",controller:"AddOrderController"}).when("/ghost",{templateUrl:"/pages/ghost.html",controller:"AddOrderController"}).when("/content",{template:"<div></div>",controller:function(){window.location.replace("http://"+jp_domain+"/content")}}).when("/profile",{template:"<div></div>",controller:function(){window.location.replace("http://"+jp_domain+"/profile")}}).when("/signout",{template:"<div></div>",controller:"SignOutController"}).when("/rss",{templateURL:"/pages/rss.xml",controller:"AddOrderController"}).otherwise({templateUrl:"/pages/detail.html",controller:"DetailController"});a.html5Mode(true)});japodeApp.config(function(a){a.resourceUrlWhitelist(["self","http://japode.prj.viglet.co/**"])});japodeApp.config(function(a){a.extendConfig({clientId:"demoapp",redirectUri:"http://other.prj.viglet.co/demo.html",state:["8eb162ee707d7dcb1ac0940d05316110"]})});japodeApp.controller("DemoCtrl",function(a,b,c,d){b.accessToken=d.get();b.authenticate=function(){var e=b.askApproval?{approval_prompt:"force"}:{};d.getTokenByPopup(e).then(function(f){b.accessToken=f.access_token;b.expiresIn=f.expires_in;d.set(f.access_token)},function(){alert("Failed to get token from popup.")})};b.signoff=function(){d.clear()}});japodeApp.controller("OAuthLoginController",function(a,c){var b=a.askApproval?{approval_prompt:"force"}:{};c.getTokenByPopup(b).then(function(d){a.accessToken=d.access_token;a.expiresIn=d.expires_in;c.set(d.access_token)},function(){alert("Failed to get token from popup.")})});japodeApp.controller("SignOutController",function(a,b){a.signout=b.clear();window.location.replace("/")});japodeApp.controller("DetailController",function(b,d,c){var a="http://"+jp_domain+"/services/furl"+c.url()+"/";d.get(a).success(function(e){b.post=e});b.orderProp="date";b.checkURL=c.url()});japodeApp.controller("WelcomeController",function(a){a.message="This is Add new order screen"});japodeApp.controller("AddOrderController",function(a){a.message="This is Add new order screen"});japodeApp.controller("ShowOrdersController",function(a){a.message="This is Show orders screen"});japodeApp.controller("PostListCtrl",function(b,e,a,d){b.accessToken=d.get();var c="http://"+jp_domain+"/services/posts/";e.get(c).success(function(f){b.posts=f});b.orderProp="date";b.jpTemplate="postView";b.postURL=function(f){return f.replace(/\ /g,"-")};b.postTemplate;b.init=function(h,f,g){b.postTemplate=g};b.editPost=function(g,f){return a.trustAsResourceUrl("http://"+jp_domain+"/post/editorform/"+g+"/"+f+"/")};b.$on("$includeContentLoaded",function(f){tinymce.init({selector:"textarea.editme"})})});japodeApp.controller("PostCtrl",function(b,d,a,c){b.accessToken=c.get();b.postTemplate;b.init=function(g,e,f){b.regionname=e;b.posttypename=g;var h=a.trustAsResourceUrl("http://"+jp_domain+"/services/region/"+b.regionname+"/"+b.posttypename+"/");d.get(h).success(function(i){b.post=i});b.postTemplate=f};b.editPost=function(f,e){b.postTemplate=a.trustAsResourceUrl("http://"+jp_domain+"/post/editorform/"+f+"/"+e+"/");return b.postTemplate};b.$on("$includeContentLoaded",function(e){tinymce.init({selector:"textarea.editme"})})});japodeApp.controller("PostTypeListCtrl",function(b,d,a){var c="http://"+jp_domain+"/services/posttypes/";d.get(c).success(function(e){b.posttypes=e});b.orderProp="name";b.changePostType=function(e){$("#postEditForm").load(a.trustAsResourceUrl("http://"+jp_domain+"/post/editorform/"+e+"/"),function(g,f,i){if(f=="error"){var h="Sorry but there was an error: ";$("#error").html(h+i.status+" "+i.statusText)}})}});japodeApp.controller("WidgetListCtrl",function(a,c){var b="http://"+jp_domain+"/services/widgets/";c.get(b).success(function(d){a.widgets=d});a.orderProp="name"});japodeApp.controller("LabelListCtrl",function(a,c){var b="http://"+jp_domain+"/services/labels.json";c.get(b).success(function(d){a.labels=d});a.orderProp="hash"});japodeApp.controller("SiteListCtrl",function(b,c){var a="http://"+jp_domain+"/services/sites/";c.get(a).success(function(d){b.sites=d});b.orderProp="name"});japodeApp.directive("jpRegion",function(){return{restrict:"AEC",scope:{jpRgname:"@",jpPosttype:"@",jpTemplate:"@",jpList:"@"},templateUrl:function(b,a){if(a.jpList==="true"){return"http://"+jp_domain+"/template/jpList.html"}else{return"http://"+jp_domain+"/template/jpRegion.html"}}}});